@model System.Data.DataTable
@using System.Data
@using Supdate.Util
@{
  Layout = null;
  var firstRow = Model.Rows[0];
}
<div class="row">
  <div class="col-lg-12">
    <section class="panel">
      <header class="panel-heading panel-heading-main">
        @ViewBag.Title
      </header>
      <div class="panel-body">
        <p>
          Use the options below to select the correct columns.
          <br />A preview of your recipients will then be shown.
          <br />Once you're happy, click the 'Import Now' button at the bottom of the page.
        </p>
        <hr />
        <div class="form-group col-md-8 col-xs-12">
          <input type="checkbox" checked="checked" id="toggleHeader" />
          <span>The first row of my CSV contains column headings.</span>
        </div>
        <div class="form-group col-md-4 col-xs-12">
          <input type="checkbox" id="deleteExisting" name="deleteExisting" value="true"/>
          <input type="hidden"  name="deleteExisting" value="false" />
          <span>Delete all existing recipients.</span>
        </div>
        <div class="form-group col-md-4 col-xs-12">
          <label>Email Address Field</label>
          <select class="form-control toggleValues" id="EmailField" name="EmailField">
            @foreach (DataColumn col in Model.Columns)
            {
              <option value="@col.Ordinal" data-value-header="@col.ColumnName" data-value-noheader="Col @ConversionUtil.IntToExcelColumnName(col.Ordinal) (@firstRow[col.ColumnName])">@col.ColumnName</option>
            }
          </select>
        </div>
        <div class="form-group col-md-4 col-xs-12">
          <label>First Name Field</label>
          <select class="form-control toggleValues" id="FirstNameField" name="FirstNameField">
            <option value="-1">-none-</option>
            @foreach (DataColumn col in Model.Columns)
            {
              <option value="@col.Ordinal" data-value-header="@col.ColumnName" data-value-noheader="Col @ConversionUtil.IntToExcelColumnName(col.Ordinal) (@firstRow[col.ColumnName])">@col.ColumnName</option>
            }
          </select>
        </div>
        <div class="form-group col-md-4 col-xs-12">
          <label>Last Name Field</label>
          <select class="form-control toggleValues" id="LastNameField" name="LastNameField">
            <option value="-1">-none-</option>
            @foreach (DataColumn col in Model.Columns)
            {
              <option value="@col.Ordinal" data-value-header="@col.ColumnName" data-value-noheader="Col @ConversionUtil.IntToExcelColumnName(col.Ordinal) (@firstRow[col.ColumnName])">@col.ColumnName</option>
            }
          </select>
        </div>
      </div>
    </section>
  </div>
</div>
